<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>PHOENIX QUANTUM TERMINAL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700;800&display=swap');
        
        :root {
            --neon: #00ff41;
            --neon-red: #ff003c;
            --terminal-bg: #000a00;
        }

        body {
            background-color: #000;
            color: var(--neon);
            font-family: 'JetBrains Mono', monospace;
            height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .terminal-shell {
            width: 95%;
            max-width: 420px;
            height: 92vh;
            background: rgba(0, 10, 0, 0.95);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 1.5rem;
            display: flex;
            flex-direction: column;
            position: relative;
            box-shadow: 0 0 30px rgba(0, 255, 65, 0.1);
        }

        .glow-text { text-shadow: 0 0 10px var(--neon); }
        .glow-red { text-shadow: 0 0 10px var(--neon-red); color: var(--neon-red); }
        
        .price-up { color: var(--neon); text-shadow: 0 0 20px var(--neon); }
        .price-down { color: var(--neon-red); text-shadow: 0 0 20px var(--neon-red); }

        .progress-bar {
            height: 4px;
            background: #1a1a1a;
            border-radius: 2px;
            overflow: hidden;
        }

        .custom-scroll::-webkit-scrollbar { width: 2px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: var(--neon); }
    </style>
</head>
<body>

    <div class="terminal-shell border-t-4 border-t-green-500">
        <div class="p-6 border-b border-green-900/30">
            <div class="flex justify-between items-center mb-1">
                <span class="text-[10px] font-black tracking-[0.3em] opacity-50 uppercase">Neural Bridge V2</span>
                <div id="status-led" class="flex items-center gap-2">
                    <span id="status-text" class="text-[9px] font-bold">OFFLINE</span>
                    <div class="w-2 h-2 rounded-full bg-red-600 animate-pulse"></div>
                </div>
            </div>
            <h1 class="text-xl font-black tracking-tighter glow-text italic">PHOENIX QUANTUM</h1>
        </div>

        <div class="flex-1 flex flex-col p-6 overflow-hidden">
            <div class="text-center mb-8">
                <div id="asset-label" class="text-[8px] bg-green-500/10 inline-block px-3 py-1 rounded-full border border-green-500/20 mb-4 opacity-70 uppercase tracking-widest">Z-CRY/IDX (Neural Feed)</div>
                <div id="price-main" class="text-5xl font-black tracking-tighter tabular-nums opacity-20 transition-all duration-75">0.00000000</div>
            </div>

            <div class="grid grid-cols-2 gap-4 mb-8">
                <div class="bg-black/50 border border-green-900/40 p-4 rounded-xl">
                    <div class="text-[7px] uppercase opacity-40 mb-1 font-bold">RSI Oscillator</div>
                    <div id="rsi-val" class="text-lg font-black tracking-tight">50.00</div>
                    <div class="progress-bar mt-2">
                        <div id="rsi-bar" class="h-full bg-green-500 transition-all" style="width: 50%"></div>
                    </div>
                </div>
                <div class="bg-black/50 border border-green-900/40 p-4 rounded-xl">
                    <div class="text-[7px] uppercase opacity-40 mb-1 font-bold">Network Ping</div>
                    <div id="ping-val" class="text-lg font-black tracking-tight text-blue-400">0ms</div>
                    <div class="text-[7px] opacity-40 mt-2 uppercase">Sync: <span id="sync-val">0%</span></div>
                </div>
            </div>

            <div class="mb-8">
                <div class="flex justify-between text-[8px] font-bold uppercase mb-2">
                    <span class="text-green-500">Call <span id="call-pct">50%</span></span>
                    <span class="text-red-500">Put <span id="put-pct">50%</span></span>
                </div>
                <div class="progress-bar flex">
                    <div id="call-bar" class="h-full bg-green-500 transition-all" style="width: 50%"></div>
                    <div id="put-bar" class="h-full bg-red-500 transition-all" style="width: 50%"></div>
                </div>
            </div>

            <div class="flex-1 overflow-hidden flex flex-col">
                <div class="text-[7px] uppercase opacity-30 mb-2 font-bold tracking-widest">Neural Console</div>
                <div id="console" class="flex-1 overflow-y-auto text-[8px] space-y-1 custom-scroll opacity-40 italic">
                    <div>> System initialized...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // PENTING: Ganti dengan URL Render Anda!
        const CONFIG = {
            wsUrl: "wss://bridgev1.onrender.com/ws", 
            reconnectInterval: 3000
        };

        let state = {
            socket: null,
            lastPrice: 0,
            reconnects: 0
        };

        function addLog(msg, color = "") {
            const consoleEl = document.getElementById('console');
            const div = document.createElement('div');
            div.className = color;
            div.innerText = `> [${new Date().toLocaleTimeString()}] ${msg}`;
            consoleEl.prepend(div);
            if(consoleEl.children.length > 15) consoleEl.lastChild.remove();
        }

        function connect() {
            if (state.socket) state.socket.close();

            addLog("Attempting Neural Handshake...");
            state.socket = new WebSocket(CONFIG.wsUrl);

            state.socket.onopen = () => {
                state.reconnects = 0;
                document.getElementById('status-text').innerText = "CONNECTED";
                document.getElementById('status-led').children[1].className = "w-2 h-2 rounded-full bg-green-500 shadow-[0_0_10px_#00ff41]";
                document.getElementById('sync-val').innerText = "100%";
                addLog("Neural Bridge Active.", "text-green-400 font-bold");
            };

            state.socket.onmessage = (event) => {
                try {
                    const data = JSON.parse(event.data);
                    
                    if (data.type === "tick") {
                        const priceEl = document.getElementById('price-main');
                        const rsiEl = document.getElementById('rsi-val');
                        
                        // Update Price
                        const price = parseFloat(data.price);
                        priceEl.innerText = price.toFixed(8);
                        priceEl.style.opacity = "1";

                        if (price > state.lastPrice) priceEl.className = "text-5xl font-black tracking-tighter tabular-nums price-up";
                        else if (price < state.lastPrice) priceEl.className = "text-5xl font-black tracking-tighter tabular-nums price-down";
                        
                        state.lastPrice = price;

                        // Update RSI
                        rsiEl.innerText = data.rsi.toFixed(2);
                        document.getElementById('rsi-bar').style.width = data.rsi + "%";
                        if (data.rsi >= 70) rsiEl.className = "text-lg font-black tracking-tight text-red-500";
                        else if (data.rsi <= 30) rsiEl.className = "text-lg font-black tracking-tight text-green-500";
                        else rsiEl.className = "text-lg font-black tracking-tight text-white";

                        // Update Opinions
                        document.getElementById('call-pct').innerText = data.call_pct + "%";
                        document.getElementById('put-pct').innerText = data.put_pct + "%";
                        document.getElementById('call-bar').style.width = data.call_pct + "%";
                        document.getElementById('put-bar').style.width = data.put_pct + "%";
                        
                        // Update Ping
                        document.getElementById('ping-val').innerText = Math.floor(Math.random() * 30 + 15) + "ms";
                    }
                } catch (e) { }
            };

            state.socket.onclose = () => {
                document.getElementById('status-text').innerText = "RECONNECTING";
                document.getElementById('status-led').children[1].className = "w-2 h-2 rounded-full bg-red-600 animate-pulse";
                document.getElementById('price-main').style.opacity = "0.2";
                
                state.reconnects++;
                addLog("Link Severed. Retrying...", "text-red-400");
                setTimeout(connect, CONFIG.reconnectInterval);
            };
        }

        window.onload = connect;
    </script>
</body>
</html>
