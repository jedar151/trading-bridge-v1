<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PHOENIX MICRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;800&display=swap" rel="stylesheet">
    <style>
        body { background: #000; color: #00ff41; font-family: 'JetBrains Mono', monospace; overflow: hidden; }
        .grid-panel { background: rgba(0, 20, 0, 0.4); border: 1px solid #004400; }
        .btn-micro { font-size: 8px; font-weight: 800; border: 1px solid #004400; transition: 0.1s; background: #000; }
        .btn-micro:active { background: #00ff41; color: #000; }
        #price-display { font-size: 2.8rem; letter-spacing: -2px; text-shadow: 0 0 15px rgba(0,255,65,0.4); }
        .log-text { font-size: 8px; line-height: 1.1; font-style: italic; opacity: 0.7; }
        .status-dot { width: 4px; height: 4px; border-radius: 50%; }
    </style>
</head>
<body class="p-1">
    <div class="h-screen flex flex-col border border-[#004400] rounded-lg overflow-hidden">
        
        <div class="flex justify-between items-center px-2 py-1 bg-[#001100] border-b border-[#004400]">
            <div class="flex items-center gap-1">
                <div id="led" class="status-dot bg-red-500 animate-pulse"></div>
                <span class="text-[7px] font-bold tracking-widest uppercase">Z-PHOENIX v1.0</span>
            </div>
            <span id="clock" class="text-[8px] tabular-nums opacity-50">00:00:00</span>
        </div>

        <div class="flex-none py-2 flex flex-col items-center justify-center">
            <span class="text-[6px] opacity-40 tracking-[0.3em] uppercase">Market_Live::IDX</span>
            <div id="price-display" class="font-black">0.000000</div>
            <div id="price-move" class="text-[9px] font-bold mt-[-5px]">--</div>
        </div>

        <div class="grid grid-cols-3 gap-1 px-2 mb-2">
            <div class="grid-panel p-1 rounded flex flex-col items-center">
                <span class="text-[5px] opacity-40 uppercase italic">Rsi(14)</span>
                <span id="rsi-val" class="text-xs font-bold text-white">--</span>
            </div>
            <div class="grid-panel p-1 rounded flex flex-col items-center">
                <span class="text-[5px] opacity-40 uppercase italic">Trend</span>
                <span id="trend-val" class="text-[7px] font-bold text-blue-400">SCAN</span>
            </div>
            <div class="grid-panel p-1 rounded flex flex-col items-center">
                <span class="text-[5px] opacity-40 uppercase italic">Signal</span>
                <span id="sig-val" class="text-[8px] font-bold text-yellow-400">WAIT</span>
            </div>
        </div>

        <div class="flex-1 mx-2 mb-2 p-2 bg-[#000800] border border-[#004400] rounded overflow-hidden flex flex-col shadow-inner">
            <div class="flex justify-between items-center mb-1 border-b border-[#002200]">
                <span class="text-[6px] text-green-800 uppercase font-bold">Intelligence_Feed</span>
                <div id="ai-load" class="hidden w-2 h-2 border border-green-500 border-t-transparent rounded-full animate-spin"></div>
            </div>
            <div id="logs" class="flex-1 overflow-y-auto space-y-1 custom-scroll">
                <div class="log-text">>> System Initialized...</div>
            </div>
        </div>

        <div class="p-2 grid grid-cols-3 gap-1 bg-[#000800]">
            <button onclick="masterScan()" class="btn-micro py-2 rounded text-green-500">SCAN_AI</button>
            <button onclick="window.location.reload()" class="btn-micro py-2 rounded text-white/40">REFRESH</button>
            <button onclick="initWS()" class="btn-micro py-2 rounded bg-green-900/20 text-green-400">SYNC</button>
        </div>
    </div>

    <div id="overlay" onclick="this.style.display='none'" class="fixed inset-0 bg-black/95 z-50 hidden flex-col items-center justify-center p-8 border-4 border-green-900/20">
        <div id="sig-type" class="text-8xl font-black italic tracking-tighter">---</div>
        <div id="sig-msg" class="text-[10px] text-gray-400 mt-4 text-center border-t border-white/10 pt-4 leading-relaxed italic"></div>
        <div class="mt-10 text-[6px] opacity-20 uppercase tracking-widest">Tap to close</div>
    </div>

    <script>
        // Multi-API Key Support
        const apiKeys = ["AIzaSyCcqWb1-wMQM6ckq9Mhkj6OVaWWBbAAZ4k","AIzaSyDHDuGMQqtQe823WMlYQuT8lls0B3DLIgg","AIzaSyDDkSc9ia7jTku-MzmjRVghR35ZnxRokpo","AIzaSyBy9XUnMeMAEsDV7M5Hpk36U8Q5uRG1Xlk","AIzaSyDbQgQXyV0mCnyhiRUchdm8AEqg8ie-dXg"];
        let currentKey = 0;
        let state = { ws: null, price: 0, rsi: 50 };

        function addLog(m, c="text-white/40") {
            const logs = document.getElementById('logs');
            const div = document.createElement('div');
            div.className = `log-text ${c}`;
            div.innerHTML = `>> ${m}`;
            logs.appendChild(div);
            logs.scrollTop = logs.scrollHeight;
        }

        function initWS() {
            const url = (location.protocol==='https:'?'wss:':'ws:') + '//' + location.host + '/ws';
            state.ws = new WebSocket(url);
            state.ws.onopen = () => {
                document.getElementById('led').classList.replace('bg-red-500', 'bg-green-500');
                addLog("Link Stable", "text-green-500");
            };
            state.ws.onmessage = (e) => {
                const d = JSON.parse(e.data);
                const old = state.price;
                state.price = d.price;
                state.rsi = d.rsi;
                
                document.getElementById('price-display').innerText = d.price.toFixed(6);
                document.getElementById('price-display').style.color = d.price >= old ? '#00ff41' : '#ff3131';
                document.getElementById('rsi-val').innerText = d.rsi.toFixed(1);
                document.getElementById('trend-val').innerText = d.trend;
                
                const diff = d.price - old;
                document.getElementById('price-move').innerText = (diff>=0?'+':'')+diff.toFixed(6);
                document.getElementById('price-move').style.color = diff>=0?'rgba(0,255,65,0.4)':'rgba(255,49,49,0.4)';
                
                if(d.rsi > 82 || d.rsi < 18) {
                    document.getElementById('sig-val').innerText = d.rsi > 82 ? "PUT" : "CALL";
                    document.getElementById('sig-val').className = "text-[8px] font-bold " + (d.rsi > 82 ? "text-red-500" : "text-green-500");
                }
            };
            state.ws.onclose = () => {
                document.getElementById('led').classList.replace('bg-green-500', 'bg-red-500');
                setTimeout(initWS, 3000);
            };
        }

        async function masterScan() {
            const aiLoad = document.getElementById('ai-load');
            aiLoad.classList.remove('hidden');
            const p = `Crypto IDX Analysis (10 words): Price ${state.price}, RSI ${state.rsi}. Signal CALL/PUT/WAIT?`;
            
            let success = false;
            for(let i=0; i < apiKeys.length && !success; i++) {
                try {
                    const r = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKeys[currentKey]}`, {
                        method:'POST', headers:{'Content-Type':'application/json'},
                        body: JSON.stringify({contents:[{parts:[{text:p}]}]})
                    });
                    const d = await r.json();
                    const res = d.candidates[0].content.parts[0].text;
                    addLog(res, "text-white font-bold italic");
                    if(res.includes("CALL") || res.includes("PUT")) {
                        const t = res.includes("CALL") ? "CALL" : "PUT";
                        const o = document.getElementById('overlay');
                        const st = document.getElementById('sig-type');
                        st.innerText = t;
                        st.className = `text-8xl font-black italic tracking-tighter ${t==='CALL'?'text-green-500':'text-red-500'}`;
                        document.getElementById('sig-msg').innerText = res;
                        o.style.display = 'flex';
                    }
                    success = true;
                } catch(e) {
                    currentKey = (currentKey + 1) % apiKeys.length;
                    addLog("Switching Key...", "text-red-500/50");
                }
            }
            aiLoad.classList.add('hidden');
        }

        setInterval(() => document.getElementById('clock').innerText = new Date().toLocaleTimeString('en-GB'), 1000);
        window.onload = initWS;
    </script>
</body>
</html>
